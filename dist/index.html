<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    <title>Tirvan Kahvila - Pizza, Kebab & Lounasbuffet Utti</title>
    <meta name="description" content="Tirvan Kahvila Utissa tarjoaa tuoreita pizzoja, maukkaita kebabeja ja lounasbuffetin. Tilaa verkossa tai soita +358 41 3152619. Pasintie 2, 45410 Utti." />
    <meta property="og:title" content="Tirvan Kahvila - Pizza, Kebab & Lounasbuffet Utti" />
    <meta property="og:description" content="Tirvan Kahvila Utissa tarjoaa tuoreita pizzoja, maukkaita kebabeja ja lounasbuffetin. Tilaa verkossa tai soita +358 41 3152619." />
    <meta property="og:type" content="website" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#dc2626">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" href="/generated-icon.png">
    <script type="module" crossorigin src="/assets/index-DyrpofP4.js"></script>
    <link rel="modulepreload" crossorigin href="/assets/vendor-1XCZ5AD1.js">
    <link rel="modulepreload" crossorigin href="/assets/ui-DUBbscaS.js">
    <link rel="stylesheet" crossorigin href="/assets/index-BlkVn9ah.css">
  </head>
  <body>
    <div id="root">
      <div style="display: flex; justify-content: center; align-items: center; height: 100vh; font-family: Inter, sans-serif;">
        <div style="text-align: center;">
          <div style="width: 50px; height: 50px; border: 3px solid #dc2626; border-top: 3px solid transparent; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
          <p>Sivusto latautuu... / Loading website...</p>
        </div>
      </div>
      <style>
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      </style>
    </div>
    
    <script>
      // Debug script loading
      console.log('üöÄ Starting application...');
      
      // Clear old caches on load to prevent stale asset issues
      if ('caches' in window) {
        caches.keys().then((cacheNames) => {
          const oldCaches = cacheNames.filter(name => 
            name.includes('tirva-customer-v1') || 
            name.includes('tirva-customer-v2') ||
            name.includes('tirva-static-v1') ||
            name.includes('tirva-static-v2')
          );
          
          if (oldCaches.length > 0) {
            console.log('üßπ Clearing old caches:', oldCaches);
            Promise.all(oldCaches.map(cache => caches.delete(cache)))
              .then(() => console.log('‚úÖ Old caches cleared'));
          }
        });
      }
      
      // Function to clear cache and reload
      async function clearCacheAndReload() {
        if ('caches' in window) {
          const cacheNames = await caches.keys();
          await Promise.all(cacheNames.map(cache => caches.delete(cache)));
          console.log('üßπ All caches cleared');
        }
        
        // Unregister service worker
        if ('serviceWorker' in navigator) {
          const registrations = await navigator.serviceWorker.getRegistrations();
          await Promise.all(registrations.map(reg => reg.unregister()));
          console.log('üßπ Service workers unregistered');
        }
        
        // Force reload with cache bypass
        window.location.reload(true);
      }
      
      // Error handling for module loading
      window.addEventListener('error', (e) => {
        console.error('‚ùå Global error:', e.error);
        if (e.error && e.error.message && e.error.message.includes('module script')) {
          console.error('‚ùå Module script error - likely MIME type issue');
          document.getElementById('root').innerHTML = `
            <div style="padding: 20px; text-align: center; font-family: Inter, sans-serif; color: #dc2626;">
              <h2>Moduulin latausvirhe / Module Loading Error</h2>
              <p>Sivuston lataus ep√§onnistui. Yrit√§ p√§ivitt√§√§ sivu.</p>
              <p>Website loading failed. Please try refreshing the page.</p>
              <button onclick="clearCacheAndReload()" style="padding: 10px 20px; margin: 10px; background: #dc2626; color: white; border: none; border-radius: 5px; cursor: pointer;">
                Tyhjenn√§ v√§limuisti / Clear Cache
              </button>
              <button onclick="window.location.reload()" style="padding: 10px 20px; margin: 10px; background: #666; color: white; border: none; border-radius: 5px; cursor: pointer;">
                P√§ivit√§ sivu / Refresh Page
              </button>
              <details style="margin-top: 20px; text-align: left;">
                <summary>Technical Details</summary>
                <pre style="background: #f5f5f5; padding: 10px; border-radius: 5px; overflow: auto;">${e.error.message}</pre>
              </details>
            </div>
          `;
        }
      });
      
      // Check if main script loads
      const script = document.createElement('script');
      script.type = 'module';
      script.src = '/src/main.tsx';
      script.onload = () => console.log('‚úÖ Main script loaded successfully');
      script.onerror = (e) => {
        console.error('‚ùå Failed to load main script:', e);
        document.getElementById('root').innerHTML = `
          <div style="padding: 20px; text-align: center; font-family: Inter, sans-serif; color: #dc2626;">
            <h2>Latausvirhe / Loading Error</h2>
            <p>Sivuston lataus ep√§onnistui. Tarkista internetyhteys ja yrit√§ uudelleen.</p>
            <p>Website loading failed. Please check your internet connection and try again.</p>
            <button onclick="clearCacheAndReload()" style="padding: 10px 20px; margin: 10px; background: #dc2626; color: white; border: none; border-radius: 5px; cursor: pointer;">
              Tyhjenn√§ v√§limuisti / Clear Cache
            </button>
            <button onclick="window.location.reload()" style="padding: 10px 20px; margin: 10px; background: #666; color: white; border: none; border-radius: 5px; cursor: pointer;">
              P√§ivit√§ sivu / Refresh Page
            </button>
          </div>
        `;
      };
    </script>
  </body>
</html>
